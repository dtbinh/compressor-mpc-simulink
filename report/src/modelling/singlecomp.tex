\section{Compressor Model}
\label{sec:mod:comp}

The single compressor unit used in this work, depicted in Figure~\ref{fig:mod:single_comp}, refers to a centrifugal compressor driven by a variable-speed electric motor, with a tank at both the inlet (suction) and outlet (discharge).
Both the suction and discharge tanks are connected to atmospheric pressure by a valve.
These suction and discharge valves represent the flow conditions upstream and downstream of the compressor, respectively, such that various flow conditions and disturbances can be simulated by simply changing the position of the valves.
The artificial disturbances applied using these valves are designed to mimic situations frequently encountered in industrial applications (e.g. shutdown or startup of a downstream compressor).
A third, recycle (or anti-surge) valve connects the outlet tank to the inlet tank. Its primary purpose is to open when the compressor approaches surge in order to decrease the compressor load and increase the mass flow through the compressor, thus pulling it away from the surge line.

\begin{figure}
  \centering
  \resizebox{0.7\linewidth}{!}{%
    \begin{tikzpicture}
      \drawcomp
    \end{tikzpicture}
  }
  \caption{Compressor model used in simulation}
  \label{fig:mod:single_comp}
\end{figure}


The input to the motor driving the compressor is the target motor torque.
It is assumed that a cascaded regulator maintains the torque at the desired setpoint with a dynamic response fast enough to be neglected at the time scales considered (on the order of 10s of ms).
Torque is chosen as the input variable as it allows a faster response time compared to motor speed, which is generally slower as it requires the use of cascaded torque and speed controllers.
The inputs to the compressor are thus the positions of the inlet, outlet and recycle valves, as well as the motor torque.
It should be noted that the torque can be adjusted in time scales on the order of tens of milliseconds while the valves move on the order of hundreds of milliseconds.
In particular, the recycle valve has a dead time that varies as a function of the valve opening. For simplification, it was assumed constant and equal to the worst-case dead-time, identified in \cite{Cortinovis2015} to be \u{2}{s}.


The compressor model used is based on the Gravdahl-Greitzer model described in \cite{Gravdahl1999}. It is defined by five states: the suction (\g{ps}) and discharge (\g{pd}) pressures, the mass flow through the compressor (\g{qc}), the rotational speed of the compressor (\g{omegac}), and the mass flow rate through the recycle valve (\g{qr}).
The differential equations governing these states are given by:

\begin{equation}
    \dt{} \ubrace{\begin{bmatrix}
      \g{ps}\\
      \g{pd}\\
      \g{qc}\\
      \g{omegac}\\
      \g{qr}
    \end{bmatrix}}{\g{nominalstate}} =
    \ubrace{\begin{bmatrix}
      \frac{\g{a}^2}{\g{Vs}}\left(\g{qs}+\g{qr}-\g{qc}\right)\\
      \frac{\g{a}^2}{\g{Vd}}\left(\g{qc}-\g{qr}-\g{qd}\right)\\
      \frac{\g{A}}{\g{lc}}\left(\g{Pi_ss}\left(\g{alpha},\ \g{omegac},\ \g{qc} \right)\g{ps} - \g{pd}  \right)\\
      \frac{1}{\g{Jcomp}}\left(\g{torque} - \g{airtorque}\left(\g{beta},\ \g{omegac},\ \g{qc}\right)\right)\\
      \frac{1}{\g{taur}}\left(\g{ur} - \g{urSP} \right)
    \end{bmatrix}}{\g{nominalderiv}}
  \label{eq:mod:single_comp_states}
\end{equation}

\begin{equation}
  \begin{split}
    q_\text{s} & = q_\text{s}(\vc{\gamma},\ u_{\text{s}},\ p_\text{s},\ p_{\text{in}})\\
    q_\text{r} & = q_\text{r}(\vc{\delta},\ u_\text{r},\ p_\text{s},\ p_\text{d})\\
    q_\text{d} & = q_\text{d}(\vc{\varepsilon},\ u_{\text{d}},\ p_{\text{out}},\ p_\text{d}),
  \end{split}
\end{equation}

\noindent where:

\begin{itemize}[noitemsep]
  \item \g{a} is the speed of sound;
  \item \g{Vs} and \g{Vd} are the suction and discharge tank volumes, respectively;
  \item \g{qs}, \g{qr}, and \g{qd} are the mass flows across the suction valve, recycle valve, and discharge valve, respectively;
  \item \g{A} is the cross-sectional area of the piping after the compressor and \g{lc} the duct length;
  \item \g{Pi_ss}$\left(\g{alpha},\g{omegac}, \g{qc} \right)$ is a polynomial mapping giving the steady-state pressure ratio across the compressor, and \g{alpha} contains the coefficients mapping this ratio to the compressor speed and mass flow;
  \item \g{Jcomp} is the inertia of the system;
  \item \g{beta} contains the parameters mapping the steady-state torque results from air compression to the mass flow and rotational speed of the compressor;
  \item \g{taur} and \g{urSP} the time constant of the recycle valve and its setpoint, respectively;
  \item \g{gamma}, \g{delta} and \g{epsilon} are the coefficients mapping mass flow through the suction, recycle and discharge valves, respectively, to the pressure differential across the valve;
  \item \g{us} and \g{ud} are the positions of the suction and discharge valves, respectively;
  \item \g{pin} and \g{pout} are the pressures upstream and downstream of the compressor, respectively; and
  \item \g{nominalstate} and \g{nominalderiv} are vectors representing the nominal state and state derivative of a single compressor, respectively.
\end{itemize}

The interested reader may refer to \cite{Cortinovis2015} for further information on the identification and validation of this model.

