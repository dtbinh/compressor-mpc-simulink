\section{Parallel System}
\label{sec:mod:parallel}

The parallel compressor system, shown in \fig{mod:parallel} consists of two compressors whose discharge tanks both feed into a common tank, which has a separate discharge valve and a downstream atmospheric pressure boundary condition.
For simplicity, the two compressors are assumed to have identical parameters and behavior, and the discharge valve of the common tank is assumed to have the same characteristic as the discharge valves of the compressors.

\begin{figure}
  \centering
  \input{modelling/diagram_parallel.tex}
  \caption[Diagram of parallel compressor system.]{Diagram of parallel compressor system with inputs and states labelled.}
  \label{fig:mod:parallel}
\end{figure}



The model used has 11 states in total: 5 states for each compressor, as described above, and another state for the pressure in the common tank. The overall system dynamics are given by:

\begin{equation}
  \dt{}
  \ubrace{\begin{bmatrix}
    \gi{nominalstate}\\
    \gii{nominalstate}\\
    \g{pt} 
  \end{bmatrix}}{\g{parstate}}
  =
  \ubrace{\begin{bmatrix}
    \gi{nominalderiv}\\
    \gii{nominalderiv}\\
    \frac{\g{a}^2}{\g{Vt}}\left(\gi{qd}+\gii{qd}-\g{qdt}\right)
  \end{bmatrix}}{\g{parderiv}},
\end{equation}

\begin{equation}
  \begin{split}
    \gi{qd} & = \gi{qd}(\gi{epsilon},\ \gi{ud},\ \g{pt},\ \gi{pd})\\
    \gii{qd} & = \gii{qd}(\gii{epsilon},\ \gii{ud},\ \g{pt},\ \gii{pd})\\
    \g{qdt} & = \g{qdt}(\g{rho},\ \g{ut},\ \g{pt},\ \g{pout})
  \end{split}
\end{equation}

\noindent where:

\begin{itemize}
  \item \g{pt} and \g{Vt} are the pressure and the volume of the common tank, respectively;
  \item \g{qdt} is the mass flow across the common tank discharge valve;
  \item \g{rho} contains the coefficients mapping the mass flow through the common tank discharge valve to the pressure differential across the valve;
  \item \g{ut} is the discharge valve opening of the common tank; and
  \item the subscripts 1 and 2 refer to values for the first and second compressor, respectively.
\end{itemize}

The inputs to the system are thus the suction, discharge and recycle valve positions for each compressor, the torque input for each compressor, and the common tank discharge valve position.
The discharge valves linking each compressor to the common tank (\gi{ud} and \gii{ud}) are, however, kept in a fully open position in order to reduce the pressure losses in the system.
The input vector used for control (\g{parin}) contains the torque and recycle valve inputs for each of the two compressors:

\begin{equation}
  \g{parin} = \begin{bmatrix} \gi{un} \\ \gii{un} \end{bmatrix}.
\end{equation}

The system outputs are given by:

\begin{equation}
  \g{parout} =
  \begin{bmatrix}
    \gi{yn}\\
    \gii{yn}\\
    \g{pt}
  \end{bmatrix}
\end{equation}

\noindent where \g{parout} gives the output vector for the parallel system, and \gi{yn} and \gii{yn} are the output vectors of the first and second compressors, respectively.

