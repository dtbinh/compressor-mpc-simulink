\section{State Estimation}
\label{sec:mpc:estimation}

All controllers are assumed to have full state information available to generate their prediction matrices.
The state estimate is obtained using an observer with a static gain $M$ as follows:

\begin{equation}
  \begin{split}
    \vc{\hat{x}}_{k|k-1}^a & = A_{k-1}^a \left(\Delta \vc{\hat{x}}_{k-1}^a - \vc{u}_{\text{r},k-2}\right) + B_{k-1}^a \Delta \vc{u}_{k-1}\\
    \vc{\hat{x}}_{k} & = \vc{\hat{x}}_{k|k-1}^a + M \left( \vc{y}_k-\vc{y}_{k-1} - C_k^a \vc{\hat{x}}_{k|k-1}^a \right)
  \end{split}
\end{equation}

\noindent where $\vc{\hat{x}}_{k|k-1}^a$ is the a priori estimate of $\vc{\hat{x}}_k^a$ and $\vc{u}_{\text{r},k-2}$ is the recycle valve input about which the system was linearized, as defined in \eqref{eq:mpc:augmented-state-eqs}.

