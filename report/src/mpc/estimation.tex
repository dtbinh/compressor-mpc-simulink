\section{State Estimation}
\label{sec:mpc:estimation}

All controllers are assumed to have full state information available to generate their prediction matrices.
The state estimate is obtained using an observer with a static gain $M$ as follows:

\begin{equation}
  \begin{split}
    \bm{\hat{x}}_{k|k-1}^a & = A_{k-1}^a \left(\Delta \bm{\hat{x}}_{k-1}^a - \bm{u}_{\text{r},k-2}\right) + B_{k-1}^a \Delta \bm{u}_{k-1}\\
    \bm{\hat{x}}_{k} & = \bm{\hat{x}}_{k|k-1}^a + M \left( \bm{y}_k-\bm{y}_{k-1} - C_k^a \bm{\hat{x}}_{k|k-1}^a \right)
  \end{split}
\end{equation}

\noindent where $\bm{\hat{x}}_{k|k-1}^a$ is the a priori estimate of $\bm{\hat{x}}_k^a$ and $\bm{u}_{\text{r},k-2}$ is the recycle valve input about which the system was linearized, as defined in \eqref{eq:mpc:augmented-state-eqs}.

