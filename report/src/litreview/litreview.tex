\chapter{Literature Review}
Compressor control using advanced techniques such as MPC is an active field of research. 
A non-exhaustive summary of the work that has been done is presented here.
It is divided into five areas: the development of compressor models used for control and simulation, MPC theory and stability analysis, MPC controller development for individual compressors, anti-surge and performance control approaches for networks of compressors and implementation of MPC controllers on embedded systems. 

\section{Compressor Models}

Two different modelling approaches are used in industry: black box and gray box. Black box models fit experimental date to a pre-defined model type (e.g. ARX, state space, neural network), whose order is then chosen to give a good fit !!! references. 
Grey-box modelling uses on a first principles approach, assuming a model structure based on the underlying physics of the system. 
The parameters of the model are then determined for the specific structure and order given. 
Here, grey-box models are considered, however black-box models are also commonly used in industry.

The underlying grey-box model used as the basis for most compressor control applications was developed by Greitzer \cite{Greitzer1976} and expanded by Moore and Greitzer \cite{Moore1985}.
They model a system consisting of a compressor, plenum and throttle for an inviscid, incompressible flow with constant time-averaged flow around the annulus. 
The equations are then developed to predict both surge and rotating stall.
The models are based on the use of compressor maps to characterize the behavior of each individual compressor, as well as parameters describing the up- and downstream processes !!!.
The Greitzer model was developed for axial compressors, however it has been shown to be also applicable to centrifugal compressors by Hansen et al. \cite{Hansen1981} 

The Moore-Greitzer model was expanded by Gravdahl and Egeland to include both a close-coupled valve and a non-constant compressor speed for axial and centrifugal compressors \cite{Gravdahl1999}. 
This updated model was used to study surge during compressor acceleration for a variable-speed compressor.

Aaslid developed the Gravdahl and Greitzer model into a Simulink model, which was then validated against test data from a gas processing plant for use in anti-surge control (ASC) \cite{Aaslid2009}. 

Galindo et al. developed a compressor map extending into the surge region was developed and experimentally validated. The model obtained was found to be accurate even during operation in the surge regime \cite{Galindo2008}.

The invariant and ``nearly invariant'' coordinates often used to describe the surge line of a compressor with little or no dependence on inlet conditions were developed by Batson et al. \cite{Batson1996}
Using these coordinate systems allows the surge conditions to be represented as a single line (for fixed-geometry compressors) irrespective of input conditions, greatly simplifying the calculation of distance to surge -- an important quantity for anti-surge control.

%Aaslid2009\\
%Batson1996\\
%Gravdahl1998\\
%Greitzer1976\\
%Moore/Greitzer model from when??\\
%Galindo2007\\
%Li2014

\section{MPC Theory}

\section{MPC for compressors}
MPC has been used in several cases to combine process and anti-surge control (ASC) -- traditionally performed by two independent controllers -- resulting in increased performance and better surge avoidance during disturbances compared to traditional PID controllers \cite{Cortinovis2015,Budinis2015}.

Cortinovis et al. showed that combined process and ASC using MPC led to a reduced distance to surge and a reduced settling time for process control in a centrifugal compressor in experiments compared to the current state-of-the-art. 
Both a discharge valve disturbance and a combined disturbance on both the discharge and the suction valve were considered \cite{Cortinovis2015}. 
The controller was implemented using linear MPC by linearizing the system at each time step. 

Similarly, Budinis and Thornhill found that a combined process/anti-surge MPC controller better handled disturbances on the inlet and outlet valves as well as changes in load pattern compared to a PID controller in simulation \cite{Budinis2015}.

Bentaleb et al. also demonstrated that an MPC controller manipulating both driver speed and the inlet guide vanes could achieve better performance than a PID controller manipulating only the driver speed, though they did not integrate anti-surge control \cite{Bentaleb2014}.

!!! Add Bentaleb thesis + other refs

%\begin{itemize}
  %\item Bentaleb2014
  %\item Bohagen2007
  %\item Boinov2006
  %\item Budinis2015
  %\item Cortinovis
  %\item COTC2010
  %\item Gravdahl
  %\item Lin2014
  %\item Mirsky2012
  %\item Moghaddam2011
  %\item Molenaar2007
  %\item Quartarone2013
  %\item Shehata2009
  %\item Zhou2015
%\end{itemize}

\section{Control of Compressor Networks}
!!! don't talk about load sharing

An MPC controller for two compressors arranged in parallel was developed by Smeulers and Bouman who considered a single controller combining load-sharing for the two compressors as well as performance and anti-surge criteria for each compressor individually \cite{Smeulers1999}. 
The controller was implemented using linear MPC, where the non-linear model was linearized at each time step to characterize the compressors' non-linear behavior more accurately.
Two objectives for load-balancing were considered: equal distance of each compressor to the surge line and minimum power consumption of the system. 
The constraints used included surge constraints for each compressor, a maximum temperature constraint on the output plenum, and actuator constraints.
The controller was implemented in simulation using a relatively high sampling time on the order of one second due to computational limitations. 
For this reason, dedicated anti-surge controllers with a smaller sampling time was necessary to open the recycle valves much quicker in the case where the compressor moves toward surge during the sampling period of the MPC controller. 
In simulation, however, these backup controllers were unused as the MPC controller successfully kept both compressors away from the surge line.

Øvervåg also considered load sharing for two parallel compressors using an MPC controller \cite{Oevervaag2013}. 
He approximated the efficiency of each compressor using continuous functions and used the minimization of the fuel consumption for the turbines driving the compressors as the optimization criterion for MPC. 
As in \cite{Smeulers1999}, linear MPC is implemented by re-linearizing the compressor models at each time step.
The focus of this work was on the load-sharing algorithm and generating set-points for each compressor; it did not consider the process and surge control of the individual compressors, though constraints were used in the load-sharing formulation to keep both compressors away from the surge line.

Load-sharing schemes based on control approaches other than MPC have also been studied. 
Blotenberg et al. proposed a load-sharing approach whereby the distance to surge for each of the compressors in parallel is driven to be equal using throttle controllers in order to minimize the opening of the recycle valves \cite{Blotenberg1984}. 

Xenos et al. used real-time optimization to determine the optimal loading of the compressor network based on compressor efficiency maps updated in real-time, and experimentally found a reduction in power consumption compared to equal load splitting \cite{Xenos2015}.

%In CCC presentation (!!!) a load-sharing scheme for parallel compressors based on equal distance to the surge line is described.
%The control is implemented using a combination of cascaded PID controllers and loop decoupling inputs to reduce the coupling effects between the compressors.

%\begin{itemize}
  %\item Blotenberg1984
  %\item Overvag2013
  %\item Paparella 2013
  %\item Peyrl2015
  %\item Smeulers1999
  %\item Xenos2015
%\end{itemize}




\section{Solvers \& Implementation}

Ferreau et al. present a quadratic programming solver using an active-set algorithm that can be used to efficiently solve QP problems, for example of the type solved at each timestep of an MPC controller \cite{Ferreau2014}. 
This solver is used for example by Cortinovis et al. to implement an MPC compressor controller on an embedded system \cite{Cortinovis2015}. 

Peyrl et al. also found that QPs generated by load-sharing MPC controllers have certain separability properties that can be exploited to more efficiently solve them using the alternating method of multipliers (ADMM) rather than a standard QP solver \cite{Peyrl2015}. For the compression station studied, ADMM was 10 times faster than a state-of-the-art QP solver, despited being implemented using code generation by Matlab Coder.




